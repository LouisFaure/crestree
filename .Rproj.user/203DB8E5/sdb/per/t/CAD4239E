{
    "collab_server" : "",
    "contents" : "#include <RcppArmadillo.h>\nusing namespace Rcpp;\n\n// [[Rcpp::depends(RcppArmadillo)]]\n\n//' calculate weighted correlation between columns of a matrix and a given vector\n//' @export\n// [[Rcpp::export]]\nNumericVector matWVCorr(NumericMatrix Mat, NumericVector Vec, NumericVector Vecw) {\n  arma::mat m=Rcpp::as<arma::mat>(Mat);\n  arma::colvec v=Rcpp::as<arma::colvec>(Vec);\n  arma::colvec vw=Rcpp::as<arma::colvec>(Vecw);\n  int n=m.n_cols;\n  int k=m.n_rows;\n  vw/=sum(vw); // normalize weight vector\n  v-=dot(v,vw);\n  arma::colvec v2=v%v;\n  arma::vec c(n);\n  for(int i=0;i<n;i++) {\n    arma::colvec ic=m.col(i);\n    // shift by weighted means\n    ic-=dot(ic,vw);\n    double nm=dot(ic % v,vw);\n    ic%=ic;\n    double dn=dot(ic,vw);\n    dn*=dot(v2,vw);\n    c(i)=nm/sqrt(dn);\n  }\n\n  return wrap(c);\n}\n",
    "created" : 1555352072378.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2966449967",
    "id" : "CAD4239E",
    "lastKnownWriteTime" : 1555352577,
    "last_content_update" : 1555352577198,
    "path" : "~/NC/crestree/src/functions.cpp",
    "project_path" : "src/functions.cpp",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "cpp"
}